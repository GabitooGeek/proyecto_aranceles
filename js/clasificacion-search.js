document.addEventListener('DOMContentLoaded', () => { const searchInput = document.getElementById('classificationSearchInput'), tableBody = document.getElementById('classificationTableBody'); if (!searchInput || !tableBody) return; const renderTable = (productos) => { tableBody.innerHTML = ''; if (productos.length === 0) { tableBody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px;">No se encontraron resultados.</td></tr>'; return; } productos.forEach(p => { tableBody.innerHTML += `<tr><td>${p.codigo}</td><td>${p.descripcion}</td><td>${p.unidad}</td><td>${p.tipo}</td><td>${p.ad_valorem}</td><td>${p.especifica}</td></tr>`; }); }; const fetchClasificaciones = async (query = '') => { tableBody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px;">Cargando datos...</td></tr>'; try { const res = await fetch(`http://localhost:8888/api/clasificacion?q=${query}`, { cache: 'no-cache' }); if (!res.ok) throw new Error('Error'); const data = await res.json(); renderTable(data); } catch (error) { tableBody.innerHTML = '<tr><td colspan="6" style="text-align: center; color: #d9534f; padding: 20px;">Error al conectar con el servidor.</td></tr>'; } }; searchInput.addEventListener('input', e => fetchClasificaciones(e.target.value)); fetchClasificaciones(); });
